{"version":3,"sources":["webpack://vuedio/./src/players/hls.js"],"names":["HlsPlayer","tech","hls","Hls","attachMedia","instance","vuedio","progressiveLevels","on","Events","MANIFEST_PARSED","ev","data","levels","map","it","i","name","height","id","selected","firstLevel","callback","currentLevel","subtitlesAvailable","subtitleTracks","length","LEVEL_SWITCHED","level","Array","isArray","SUBTITLE_TRACKS_UPDATED","subtitlesEnabled","subtitleDisplay","externalSubtitles","externalSubtitlesListener","subtitlesListener","bind","event","handler","off","removeEventListener","addEventListener","destroy","enabled","duration","paused","val","pause","play","playbackRate","src","loadSource","currentTime"],"mappings":"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","file":"vuedio.common.3.js","sourcesContent":["import Hls from 'hls.js'\r\n\r\nexport default class HlsPlayer {\r\n    constructor(tech) {\r\n        this.tech = tech\r\n        this.hls = new Hls()\r\n        this.hls.attachMedia(tech)\r\n    }\r\n\r\n    get duration() {\r\n        return this.tech.duration\r\n    }\r\n\r\n    get paused() {\r\n        return this.tech.paused\r\n    }\r\n\r\n    set paused(val) {\r\n        if (val) {\r\n            this.tech.pause()\r\n        } else {\r\n            this.tech.play()\r\n        }\r\n    }\r\n\r\n    get speed() {\r\n        return this.tech.playbackRate\r\n    }\r\n\r\n    set speed(val) {\r\n        this.tech.playbackRate = val\r\n    }\r\n\r\n    get src() {\r\n        return this.tech.src\r\n    }\r\n\r\n    set src(val) {\r\n        this.hls.loadSource(val)\r\n    }\r\n\r\n    get timestamp() {\r\n        return this.tech.currentTime\r\n    }\r\n\r\n    set timestamp(val) {\r\n        this.tech.currentTime = val\r\n    }\r\n\r\n    bind(instance) {\r\n        this.vuedio = instance\r\n        this.vuedio.progressiveLevels = true\r\n        this.hls.on(Hls.Events.MANIFEST_PARSED, (ev, data) => {\r\n            this.vuedio.progressiveLevels = (\r\n                // @ts-ignore\r\n                data.levels\r\n            ).map((it, i) => (\r\n                {\r\n                    name: it.name || it.height + 'p',\r\n                    id: i,\r\n                    selected: i === data.firstLevel,\r\n                    callback: () => {\r\n                        this.hls.currentLevel = i\r\n                    }\r\n                }\r\n            ))\r\n            this.vuedio.subtitlesAvailable = this.hls.subtitleTracks.length > 0\r\n        })\r\n        this.hls.on(Hls.Events.LEVEL_SWITCHED, (ev, { level }) => {\r\n            if (!Array.isArray(this.vuedio.progressiveLevels)) {\r\n                return\r\n            }\r\n            for (const it of this.vuedio.progressiveLevels) {\r\n                it.selected = it.id === level\r\n            }\r\n        })\r\n        this.hls.on(Hls.Events.SUBTITLE_TRACKS_UPDATED, (ev, { subtitleTracks }) => {\r\n            this.vuedio.subtitlesAvailable = subtitleTracks.length > 0\r\n            this.vuedio.subtitlesEnabled = this.hls.subtitleDisplay\r\n        })\r\n        this.vuedio.externalSubtitles = true\r\n        this.vuedio.externalSubtitlesListener = this.subtitlesListener.bind(this)\r\n    }\r\n\r\n    off(event, handler) {\r\n        this.hls.off(event, handler)\r\n        this.tech.removeEventListener(event, handler)\r\n    }\r\n\r\n    on(event, handler) {\r\n        this.hls.on(event, handler)\r\n        this.tech.addEventListener(event, handler)\r\n    }\r\n\r\n\r\n    destroy() {\r\n        this.hls.destroy()\r\n    }\r\n\r\n    subtitlesListener(enabled) {\r\n        this.hls.subtitleDisplay = enabled\r\n    }\r\n}\r\n"],"sourceRoot":""}